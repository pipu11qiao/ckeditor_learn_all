<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <title>EditorTest1</title>
</head>
<body>
<div class="paragraph-content">
    <textarea name="aaa" id="aaa">
        This is a fuck task;
    </textarea>
</div>
<img class="cke_anchor" data-cke-realelement="%3Ca%20data-obj%3D%22%7B%26quot%3Btype%26quot%3B%3A%26quot%3Bdefine%26quot%3B%2C%26quot%3Bvalue%26quot%3B%3A%26quot%3Bid1%2Cid2%26quot%3B%7D%22%3E%3C%2Fa%3E" data-cke-real-node-type="1" alt="锚点" title="锚点" align="" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" data-cke-real-element-type="anchor">
<script src="../js/jquery-1.9.1.min.js"></script>
<script src="../ckeditor/ckeditor.js"></script>
<script>
    //    var addPage = new AddPage($('.common-page'));
    var editor = CKEDITOR.replace('aaa', {
        language: 'zh-cn',
        toolbar: 'Editor',
        extraPlugins: 'test',
        toolbar_Editor: [
            {name: 'styles', items: ['Format']},
            {name: 'basicstyles', items: ['Bold', 'Italic', 'RemoveFormat']},
            {name: 'align', items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight']},
            {name: 'links', items: ['SimpleLink']},
            {name: 'paragraph', items: ['NumberedList', 'BulletedList']},
            {name: 'insert', items: ['Image', 'Table']},
            {name: 'myGroup', items: ['test']},
            {name: 'document', items: ['Source']}
        ],
        // config.removePlugins = 'elementspath';

        format_tags: 'h1;h2;h3;h4;h5;p',

        // This is optional, but will let us define multiple different styles for multiple editors using the same CSS file.
        bodyClass: 'document-editor',
        // An array of stylesheets to style the WYSIWYG area.
        // Note: it is recommended to keep your own styles in a separate file in order to make future updates painless.
        contentsCss: ['../css/ckeditor_style.css'],

        allowedContent: true,
        forcePasteAsPlainText: true
    });


    function createFakeAnchor( editor, attributes ) {
        return editor.createFakeElement( editor.document.createElement( 'a', {
            attributes: attributes
        } ), 'cke_anchor', 'anchor' );
    }
    editor.on('fuck',function (e) {
        var data = e.data;
        var editor = e.editor;
        var insertText = prompt('输入想要的文本');
        if(insertText) {
            var element = new CKEDITOR.dom.element('s');
            element.setAttribute('data-obj',
                JSON.stringify({
                type: 'define',
                value: 'id1,id2'
            })
            );
            var fakeElement = editor.createFakeElement(element,'define','fuck',true);
            var attributes = {
//                id: name,
//                name: name,
//                'data-cke-saved-name': name,
                'data-obj': JSON.stringify({
                        type: 'define',
                        value: 'id1,id2'
                    })
            };
            var selection = editor.getSelection();
            var ranges = selection.getRanges();
            var range = ranges[0];

            ranges[0].collapse(true);
            selection.selectRanges(ranges);
            debugger;

            editor.insertElement(createFakeAnchor(editor,attributes));
//            editor.insertHtml('<input class="icon">');
        }
//        var a  = arguments;

//        debugger;

    });
    console.log(decodeURIComponent('%3Ca%20data-obj%3D%22%7B%26quot%3Btype%26quot%3B%3A%26quot%3Bdefine%26quot%3B%2C%26quot%3Bvalue%26quot%3B%3A%26quot%3Bid1%2Cid2%26quot%3B%7D%22%3E%3C%2Fa%3E'));
    var a = decodeURIComponent('%3Ca%20data-obj%3D%22%7B%26quot%3Btype%26quot%3B%3A%26quot%3Bdefine%26quot%3B%2C%26quot%3Bvalue%26quot%3B%3A%26quot%3Bid1%2Cid2%26quot%3B%7D%22%3E%3C%2Fa%3E');
    var m = $(a).data('obj')
    console.log(m);
</script>
<script>

    /*
    * 节 h1
    * 条 h2
    * 款 h3
    * 项 h4
    * 目 h5
    * 普通 p
    * */
    //    config.format_h1={element:"h1", name: "节"};
    //    config.format_h2={element:"h2", name: "条"};
    //    config.format_h3={element:"h3", name: "款"};
    //    config.format_h4={element:"h4", name: "项"};
    //    config.format_h5={element:"h5", name: "目"};
    //    config.format_p={element:"p", name: "普通"};
</script>
</body>
</html>
